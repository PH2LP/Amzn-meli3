# ğŸ¯ Sistema Completo de SelecciÃ³n y Filtrado

## ğŸ“‹ RESUMEN

Este documento explica el **flujo completo** desde que el sistema encuentra una keyword hasta que publica productos en MercadoLibre, con todos los filtros y criterios de selecciÃ³n aplicados.

---

## ğŸ”„ FLUJO COMPLETO (60 min por keyword)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    KEYWORD: "wireless keyboard"              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FASE 1: BÃšSQUEDA EN AMAZON (5 min)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Buscar 100 pÃ¡ginas (10 ASINs por pÃ¡gina)                 â”‚
â”‚  â€¢ API: Amazon Product Advertising API                       â”‚
â”‚  â€¢ Sin filtros, solo extraer ASINs                           â”‚
â”‚  â€¢ Rate limit: 1 request/segundo                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                      ğŸ“¦ 1000 ASINs
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FASE 2: FILTRO PRIME (27 min) â­ FILTRO CRÃTICO            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ API: Amazon SP-API Product Pricing v0                    â”‚
â”‚  â€¢ Para cada ASIN: get_prime_offer(asin)                    â”‚
â”‚  â€¢ Delay: 0.15s por request                                  â”‚
â”‚  â€¢ Backoff: 1s â†’ 2s â†’ 4s en rate limits                     â”‚
â”‚  â€¢ Tiempo real: 1.64s/ASIN (incluye backoffs)               â”‚
â”‚                                                              â”‚
â”‚  âœ… CRITERIOS:                                               â”‚
â”‚     â€¢ is_prime = True                                        â”‚
â”‚     â€¢ price > 0 (tiene precio vÃ¡lido)                        â”‚
â”‚     â€¢ price >= $5 USD (mÃ­nimo rentable)                      â”‚
â”‚     â€¢ price <= $500 USD (mÃ¡ximo razonable)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
              ğŸ“¦ 840 Prime ASINs (~84%)
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FASE 3: BSR RANKING (28 min)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ API: Amazon Product Advertising API (ItemLookup)         â”‚
â”‚  â€¢ Para cada Prime ASIN: obtener BSR                         â”‚
â”‚  â€¢ Delay: 2s por request                                     â”‚
â”‚  â€¢ Solo de ASINs Prime (ya filtrados)                        â”‚
â”‚  â€¢ Ordenar de menor a mayor BSR                              â”‚
â”‚                                                              â”‚
â”‚  â„¹ï¸  BSR mÃ¡s bajo = mÃ¡s ventas = mejor producto             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
        ğŸ“¦ 840 Prime ordenados por BSR
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FASE 4: TOP 100 PRIME (instantÃ¡neo)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Seleccionar top 100 con mejor BSR                         â”‚
â”‚  â€¢ Ya todos son Prime                                        â”‚
â”‚  â€¢ Ya estÃ¡n ordenados por popularidad                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
            ğŸ“¦ 100 Prime Top BSR
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FASE 5: FILTRO DE DUPLICADOS (1 min)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Verificar en listings_database.db                         â”‚
â”‚  â€¢ SQL: SELECT asin FROM listings WHERE asin IN (...)       â”‚
â”‚  â€¢ Excluir ASINs ya publicados                               â”‚
â”‚                                                              â”‚
â”‚  âœ… CRITERIOS:                                               â”‚
â”‚     â€¢ ASIN no existe en DB                                   â”‚
â”‚     â€¢ ASIN no fue publicado antes (evita duplicados)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
      ğŸ“¦ 80-100 ASINs (sin duplicados)
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FASE 6: FILTRO DE MARCAS (1 min)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Verificar contra brand_blacklist.json                     â”‚
â”‚  â€¢ Extraer marca del tÃ­tulo del producto                     â”‚
â”‚  â€¢ Excluir marcas prohibidas/problemÃ¡ticas                   â”‚
â”‚                                                              â”‚
â”‚  âŒ MARCAS EXCLUIDAS (ejemplos):                             â”‚
â”‚     â€¢ Apple, Samsung, Sony (marcas grandes)                  â”‚
â”‚     â€¢ AmazonBasics (genÃ©ricos Amazon)                        â”‚
â”‚     â€¢ Marcas con derechos estrictos                          â”‚
â”‚     â€¢ ~50 marcas en blacklist                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
        ğŸ“¦ 40-60 ASINs aprobados
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FASE 7: EXTRACCIÃ“N COMPLETA (2 min)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Amazon SP-API: Catalog Items v20220401                   â”‚
â”‚  â€¢ Para cada ASIN aprobado: datos completos                  â”‚
â”‚  â€¢ TÃ­tulo, descripciÃ³n, atributos, imÃ¡genes, etc.           â”‚
â”‚  â€¢ Guardar en storage/asins_json/{ASIN}.json                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
      ğŸ“¦ 40-60 productos completos
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FASE 8: CATEGORIZACIÃ“N ML (2 min)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Buscar categorÃ­a en MercadoLibre                          â”‚
â”‚  â€¢ MÃ©todo: HÃ­brido (reglas + AI)                             â”‚
â”‚  â€¢ 1. BÃºsqueda por keywords en categorÃ­as ML                 â”‚
â”‚  â€¢ 2. Si falla: OpenAI analiza tÃ­tulo y atributos           â”‚
â”‚  â€¢ 3. Validar que categorÃ­a acepta producto                  â”‚
â”‚                                                              â”‚
â”‚  âœ… CRITERIOS:                                               â”‚
â”‚     â€¢ CategorÃ­a vÃ¡lida encontrada                            â”‚
â”‚     â€¢ CategorÃ­a acepta listing_type = gold_special           â”‚
â”‚     â€¢ Atributos requeridos disponibles                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
        ğŸ“¦ 35-55 categorizados
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FASE 9: TRANSFORMACIÃ“N (2 min)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Convertir datos Amazon â†’ formato MercadoLibre            â”‚
â”‚  â€¢ Traducir tÃ­tulo y descripciÃ³n al espaÃ±ol                  â”‚
â”‚  â€¢ Mapear atributos Amazon â†’ ML                              â”‚
â”‚  â€¢ Calcular precio con markup (1.5x - 2.5x)                 â”‚
â”‚  â€¢ Optimizar imÃ¡genes (orden, calidad)                       â”‚
â”‚                                                              â”‚
â”‚  ğŸ“ TRANSFORMACIONES:                                        â”‚
â”‚     â€¢ TÃ­tulo: Traducido, optimizado, keywords                â”‚
â”‚     â€¢ Precio: Amazon Ã— markup + envÃ­o                        â”‚
â”‚     â€¢ DescripciÃ³n: Template profesional en espaÃ±ol           â”‚
â”‚     â€¢ Atributos: Mapeados segÃºn schema ML                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
    ğŸ“¦ 35-55 listos para publicar
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FASE 10: VALIDACIÃ“N FINAL (1 min)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Verificar que todos los campos requeridos estÃ©n           â”‚
â”‚  â€¢ Validar formato de imÃ¡genes                               â”‚
â”‚  â€¢ Validar precio dentro de rango                            â”‚
â”‚  â€¢ Validar atributos segÃºn schema de categorÃ­a               â”‚
â”‚                                                              â”‚
â”‚  âœ… CRITERIOS:                                               â”‚
â”‚     â€¢ title presente (3-60 caracteres)                       â”‚
â”‚     â€¢ category_id vÃ¡lido                                     â”‚
â”‚     â€¢ price > 0                                              â”‚
â”‚     â€¢ pictures >= 1 imagen                                   â”‚
â”‚     â€¢ Atributos obligatorios completos                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
      ğŸ“¦ 30-50 100% vÃ¡lidos
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FASE 11: PUBLICACIÃ“N ML (3 min)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ API: MercadoLibre POST /items                            â”‚
â”‚  â€¢ Publicar uno por uno con rate limit                       â”‚
â”‚  â€¢ Guardar item_id en database                               â”‚
â”‚  â€¢ Manejar errores de validaciÃ³n de ML                       â”‚
â”‚                                                              â”‚
â”‚  ğŸ“Š RESULTADOS TÃPICOS:                                      â”‚
â”‚     â€¢ Publicados: 15-40 (promedio ~30)                       â”‚
â”‚     â€¢ Rechazados: 5-15                                       â”‚
â”‚     â€¢ Errores: 0-5                                           â”‚
â”‚                                                              â”‚
â”‚  âŒ RECHAZOS COMUNES:                                        â”‚
â”‚     â€¢ Producto ya existe en ML                               â”‚
â”‚     â€¢ Atributos invÃ¡lidos                                    â”‚
â”‚     â€¢ Precio fuera de rango de categorÃ­a                     â”‚
â”‚     â€¢ GTIN no vÃ¡lido                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
        âœ… 15-40 publicados
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FASE 12: GUARDAR EN DB (instantÃ¡neo)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Insertar en listings_database.db:                         â”‚
â”‚     - asin                                                   â”‚
â”‚     - item_id (ML)                                           â”‚
â”‚     - title                                                  â”‚
â”‚     - price                                                  â”‚
â”‚     - country                                                â”‚
â”‚     - status                                                 â”‚
â”‚     - published_at                                           â”‚
â”‚  â€¢ Marcar keyword como procesada                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
              âœ… COMPLETADO
```

---

## ğŸ“Š EMBUDO DE CONVERSIÃ“N

```
KEYWORD: "wireless keyboard"
â”œâ”€ 1000 ASINs iniciales (bÃºsqueda)
â”‚
â”œâ”€ 840 Prime (84%) âœ… FILTRO PRIME
â”‚  â””â”€ 160 no-Prime excluidos
â”‚
â”œâ”€ 840 ordenados BSR âœ… RANKING
â”‚
â”œâ”€ 100 top BSR âœ… SELECCIÃ“N
â”‚  â””â”€ 740 BSR bajo descartados
â”‚
â”œâ”€ 80-100 sin duplicados (80-100%) âœ… DUPLICADOS
â”‚  â””â”€ 0-20 ya publicados excluidos
â”‚
â”œâ”€ 40-60 marcas vÃ¡lidas (50%) âœ… MARCAS
â”‚  â””â”€ 40-50 marcas prohibidas excluidas
â”‚
â”œâ”€ 35-55 categorizados (87%) âœ… CATEGORÃAS
â”‚  â””â”€ 5 sin categorÃ­a descartados
â”‚
â”œâ”€ 35-55 transformados (100%) âœ… TRANSFORMACIÃ“N
â”‚
â”œâ”€ 30-50 vÃ¡lidos (88%) âœ… VALIDACIÃ“N
â”‚  â””â”€ 5 invÃ¡lidos descartados
â”‚
â””â”€ 15-40 publicados (50%) âœ… PUBLICACIÃ“N
   â””â”€ 15-25 rechazados por ML

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
CONVERSIÃ“N TOTAL: 1.5% - 4%
(15-40 publicados de 1000 iniciales)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## âš™ï¸ CRITERIOS DE FILTRADO DETALLADOS

### 1ï¸âƒ£ Filtro Prime (84% pasan)

```python
def is_valid_prime(offer):
    return (
        offer.get("is_prime") == True and
        offer.get("price", 0) > 0 and
        offer.get("price", 0) >= 5 and      # MÃ­nimo $5
        offer.get("price", 0) <= 500        # MÃ¡ximo $500
    )
```

**Por quÃ© Prime:**
- Disponibilidad garantizada
- EnvÃ­o rÃ¡pido a Argentina
- Productos confiables
- Fotos de calidad
- Descripciones completas

**Por quÃ© precio 5-500:**
- < $5: No rentable con envÃ­o
- > $500: Riesgo alto, difÃ­cil venta

---

### 2ï¸âƒ£ Top 100 BSR (12% seleccionados de Prime)

```python
def select_top_bsr(prime_asins, limit=100):
    sorted_asins = sorted(
        prime_asins,
        key=lambda x: x.get("bsr", float("inf"))
    )
    return sorted_asins[:limit]
```

**Por quÃ© top 100:**
- Productos con mÃ¡s ventas
- MÃ¡s populares = mÃ¡s demanda
- Mejor ratio publicados/aprobados
- Reviews y ratings altos

---

### 3ï¸âƒ£ Filtro Duplicados (80-100% pasan)

```python
def is_duplicate(asin):
    cursor.execute(
        "SELECT 1 FROM listings WHERE asin = ? LIMIT 1",
        (asin,)
    )
    return cursor.fetchone() is not None
```

**Por quÃ© importante:**
- MercadoLibre rechaza duplicados
- Ahorra procesamiento
- Mantiene catÃ¡logo limpio

---

### 4ï¸âƒ£ Filtro Marcas (~50% pasan)

```python
def is_brand_allowed(title, brand_blacklist):
    brand = extract_brand(title)
    return brand.lower() not in [
        b.lower() for b in brand_blacklist
    ]
```

**Marcas excluidas (ejemplos):**

```json
{
  "blacklist": [
    "Apple", "Samsung", "Sony", "LG", "Microsoft",
    "AmazonBasics", "Amazon Essentials",
    "Nike", "Adidas", "Puma",
    "Bose", "JBL", "Beats",
    "Canon", "Nikon", "GoPro",
    "...otras 30+ marcas"
  ]
}
```

**Por quÃ©:**
- Derechos de marca estrictos
- Riesgo de reclamos
- ML puede rechazar/suspender cuenta
- Marcas grandes controlan distribuciÃ³n

---

### 5ï¸âƒ£ CategorizaciÃ³n ML (87% pasan)

```python
def find_ml_category(product):
    # 1. BÃºsqueda por keywords
    category = search_by_keywords(product.title)

    if not category:
        # 2. IA analiza producto
        category = ai_categorize(product)

    # 3. Validar categorÃ­a
    if validate_category(category, product):
        return category

    return None
```

**Criterios validaciÃ³n:**
- CategorÃ­a existe en ML
- Acepta `listing_type = gold_special`
- Atributos requeridos estÃ¡n disponibles
- CategorÃ­a permite envÃ­o internacional

---

### 6ï¸âƒ£ ValidaciÃ³n Final (88% pasan)

```python
def validate_listing(listing):
    required_fields = [
        "title",        # 3-60 caracteres
        "category_id",  # VÃ¡lido en ML
        "price",        # > 0
        "currency_id",  # "ARS"
        "pictures",     # >= 1 imagen
        "attributes"    # SegÃºn schema
    ]

    for field in required_fields:
        if not listing.get(field):
            return False

    return True
```

---

### 7ï¸âƒ£ PublicaciÃ³n ML (~50% de vÃ¡lidos se publican)

**Rechazos comunes de MercadoLibre:**

```
âŒ "item.title: ya existe un item con este tÃ­tulo"
   â†’ Producto duplicado (mismo tÃ­tulo)

âŒ "item.attributes: GTIN invÃ¡lido"
   â†’ CÃ³digo de barras no coincide

âŒ "item.price: fuera de rango para categorÃ­a"
   â†’ Precio muy alto/bajo para categorÃ­a

âŒ "item.pictures: imagen no vÃ¡lida"
   â†’ URL caÃ­da o formato incorrecto

âŒ "item.attributes: BRAND es obligatorio"
   â†’ Falta atributo requerido
```

---

## ğŸ“ˆ MÃ‰TRICAS DE RENDIMIENTO

### Por Keyword (60 min)
```
Entrada:    1000 ASINs
Prime:       840 ASINs (84%)
Top 100:     100 ASINs (12% del total)
Marcas OK:    50 ASINs (5% del total)
Publicados:   30 ASINs (3% del total) â† PROMEDIO
```

### Por DÃ­a (24 keywords)
```
Entrada:    24,000 ASINs buscados
Prime:      20,160 ASINs filtrados
Procesados:  2,400 ASINs top
Publicados:    960 productos â† PRODUCTIVIDAD
```

### ConversiÃ³n Global
```
1000 ASINs iniciales
  â†“
30 publicados
  â†“
3% conversiÃ³n total
```

**Por quÃ© 3% es bueno:**
- Filtros estrictos garantizan calidad
- Prime = disponibilidad
- Top BSR = productos probados
- Marcas vÃ¡lidas = sin riesgos legales
- Sin duplicados = catÃ¡logo limpio

---

## ğŸ¯ OPTIMIZACIONES APLICADAS

### âœ… Prime ANTES de BSR
- **Antes:** Buscar BSR de 1000 â†’ Filtrar Prime â†’ 420 con BSR
- **Ahora:** Filtrar Prime 840 â†’ Buscar BSR solo de 840
- **Ahorro:** 160 requests de BSR innecesarios

### âœ… Top 100 despuÃ©s de BSR
- **Antes:** BSR de 840 â†’ Procesar 840 â†’ Publicar algunos
- **Ahora:** BSR de 840 â†’ Top 100 â†’ Procesar 100
- **Ahorro:** Procesamiento de 740 productos menos populares

### âœ… Duplicados temprano
- **Antes:** Procesar todo â†’ Duplicados al final
- **Ahora:** Duplicados despuÃ©s de Top 100
- **Ahorro:** No procesar duplicados conocidos

### âœ… Backoff inteligente
- **Antes:** Delay fijo, rate limits frecuentes
- **Ahora:** Backoff exponencial (1sâ†’2sâ†’4s)
- **Resultado:** Manejo automÃ¡tico de lÃ­mites

---

## ğŸ“ ARCHIVOS DEL SISTEMA

### ConfiguraciÃ³n
- `config/autonomous_config.json` - Config de 100 pÃ¡ginas
- `config/brand_blacklist.json` - Marcas prohibidas

### Scripts principales
- `scripts/autonomous/autonomous_search_and_publish.py` - Orquestador
- `scripts/tools/search_asins_by_keyword.py` - BÃºsqueda Amazon
- `src/integrations/amazon_pricing.py` - Filtro Prime
- `src/integrations/amazon_api.py` - BSR y datos completos
- `src/pipeline/transform_mapper_new.py` - TransformaciÃ³n Amazonâ†’ML
- `src/integrations/mainglobal.py` - PublicaciÃ³n en ML

### Datos
- `storage/listings_database.db` - ASINs publicados
- `storage/asins_json/*.json` - Productos completos
- `storage/logs/publish_ready/*_mini_ml.json` - Listos para publicar

---

## ğŸ¯ RESULTADO FINAL

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  SISTEMA DE SELECCIÃ“N Y FILTRADO COMPLETO            â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                       â•‘
â•‘  ğŸ“¥ Entrada:     1000 ASINs/keyword                   â•‘
â•‘  â­ Filtrados:    840 Prime (84%)                     â•‘
â•‘  ğŸ¯ Procesados:   100 top BSR                         â•‘
â•‘  âœ… Publicados:    30 productos (~3%)                 â•‘
â•‘                                                       â•‘
â•‘  â±ï¸  Tiempo:      60 min/keyword                      â•‘
â•‘  ğŸ“ˆ Velocidad:    24 keywords/dÃ­a                     â•‘
â•‘  ğŸ“¦ Output:       960 productos/dÃ­a                   â•‘
â•‘                                                       â•‘
â•‘  ğŸ¯ 50,000 publicaciones en 52 dÃ­as                   â•‘
â•‘                                                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**El sistema maximiza calidad sobre cantidad:**
- Solo Prime (disponibilidad)
- Solo top BSR (popularidad)
- Solo marcas seguras (sin riesgo)
- Sin duplicados (catÃ¡logo limpio)
- CategorizaciÃ³n precisa (menos rechazos)

---

**Fecha:** 2025-11-09
**VersiÃ³n:** 1.0
**Estado:** âœ… ProducciÃ³n
